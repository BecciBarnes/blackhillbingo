<!DOCTYPE html>

<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  background: #2a2724;
  color: rgba(192, 225, 255);
  font-family: 'Roboto', "Helvetica Neue", Helvetica, sans-serif;
  user-select: none;
}

*,
*::before,
*::after {
  box-sizing: inherit;
}

main {
  width: 33rem;
  margin: 33px auto;
  border: 3px solid #000000;
  border-radius: 15px;
  background: transparent;
  background-image: url(bgpic.jpg);
  background-size: cover;
}

h1 {
  padding-top: 0.1rem;
  color: #D9D9D9;
  font-size: 3rem;
  text-align: center;
  margin-bottom: 1rem;
}

h1 span {
  display: inline-block;
  width: 9.5rem;
  height: 5.7rem;
  font-size: 1.7em;
}

.grid {
  display: flex;
  flex-flow: row wrap;
  justify-content: space-around;
  width: 30rem;
  height: 30rem;
  margin: 0 auto;
}

label {
  display: block;
  width: 9.5rem;
  height: 9.5rem;
  border: 3px solid #590C05;
  border-radius: 15px;
  background:#590C05;

}

label input {
  display: none;
}

label input:checked + .mark {
  background: transparent;
  color: #D9D9D9;
}

label input:checked + .mark::before {
	content: "*  ";
}

label .mark {
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 9.15rem;
  height: 9.15rem;
  padding: .2rem;
  border-radius: 12px;
  background: #261111;
  font-size: 1em;
  text-align: center;
  color: #FFFFFF;
}

button {
  padding: .2rem;
  background: #590C05;
  font-size: .9em;
  text-align: center;
  color: #D9D9D9;
  border: 3px solid #590C05;
  border-radius: 15px;
}


small {
  display: block;
  padding: 1em;
  text-align: center;
}


</style>

     <script>
        const randomWords = [
"Era: Meso- potamia",
"Era: Golgotha",
"Era: Rome",
"Era: Wessex",
"Era: The Globe",
"Era: The Bastille",
"Era: The Holy Water Fight",
"Era: 1941",
"Era: Soho 1967",
"Era: Job",
"Era: Edinburgh",
"Era: Something not in the show",
"Era: Eden",
"Era: Before The Beginning",
"Era: Post Almost-Apocalypse",

"Posted in 2018 or earlier",
"Posted in 2019",
"Posted in 2020",
"Posted in 2021",
"Posted in 2022",
"Posted in 2023",
"Posted in 2024",

"Posted for DIWS Minibang",
"Posted for DIWS BT Tower Telephone",
"Posted For DIWS Reverse Bang",
"Posted for DIWS Who Needs A Great Plan",
"Posted for DIWS Gift Exchange",
"Posted for DIWS Extr. Amounts of cake",
"Posted for DIWS Chattering Round Robin",
"Posted For DIWS Mini Reverse Bang",
"Posted For DIWS Highway To Pail",
"Posted For DIWS Silver Screen Bang",

"Creator's first work/ first smut",
"Work with less than 5 comments",
"Work with 0 comments",
"Work with less than 20 kudos",
"Work with max. 500 words",
"Work made for a zine",
"Oneshot",
"Multichapter",
"A Series",
"A Work In Progress",

"Book Omens",
"Radio Omens",

"Angst",
"Fluff",
"Human AU",
"AU (not human)",
"Outside POV",
"Rare Ship",
"First Kiss",

"South Downs",
"Night At Crowley's Flat",
"Reverse Omens",
"Wings",

"A comic",
"Supporting character",
"Podfic",
"Fanwork displaying lyrics",
"Canon divergent",
"Character exploration",
"Tag: ‘crack treated seriously’",
"Last updated a year + ago",
"Dancing",
"Black and white",
"Epistolary",
"Crossover",
"Prophecies",
"Dialogue-only",
"Scenery",

"Multi-voice podfic",
"Collaboration",
"Character study",
"Complex world-building",
"Drabble",
"Whump",
"Sick fic",
"BAMF/ Protective character",
"5+1",
"Ambiguous/ Downer ending",
"Kid or pet fic",
"Only One Bed",
"Wedding/ Proposal",
"Established couple/ relationship",
"Domestic fluff",

"Non-AO3 work",
"Cosplay",
"Time Loop",
"Time Travel",

"Multi-Writer Fic",
"Multi-Artist Art",
"An Animatic"


        ];
		
		

function shuffleAndFill(forceShuffle = false) {

    // Retrieve and parse URL parameters
    const params = new URLSearchParams(window.location.search);
    const arrayString = params.get('saved');
	
	// Step 1: Collect locked words and their indices
    const lockedWords = {};
    for (let i = 1; i <= 9; i++) {
        const checkbox = document.querySelector(`label:nth-of-type(${i}) input[type="checkbox"]`);
        const cell = document.getElementById(`cell${i}`);
        if (checkbox && checkbox.checked && cell) {
            lockedWords[i - 1] = cell.textContent; // save zero-based index & word
        }
    }
	
	// Step 2: Get shuffled words array
    let shuffledWords = [];
    if (arrayString && forceShuffle) {
		shuffledWords = [...randomWords].sort(() => 0.5 - Math.random());
    } else if (arrayString) {
        shuffledWords = JSON.parse(decodeURIComponent(arrayString));
    } else {
        shuffledWords = [...randomWords].sort(() => 0.5 - Math.random());
    }
	
	// Step 3: Remove locked words from shuffledWords to avoid duplicates
    const lockedWordValues = Object.values(lockedWords);
    shuffledWords = shuffledWords.filter(word => !lockedWordValues.includes(word));
    
    // Step 4: Fill the cells, keeping locked words fixed, shuffle the rest
    let shuffleIndex = 0;
    for (let i = 0; i < 9; i++) {
        if (lockedWords.hasOwnProperty(i)) {
            document.getElementById(`cell${i + 1}`).textContent = lockedWords[i];
        } else {
            document.getElementById(`cell${i + 1}`).textContent = shuffledWords[shuffleIndex] || '';
            shuffleIndex++;
        }
    }
}

window.onload = () => shuffleAndFill();// Populate the div when the page loads
    </script>
</head>
<body>
  
	<main>
	<form>
	    <button type="button" onclick="shuffleAndFill()">Generate new!</button>

    <h1>
    BLACKHILL<br>
    <span>Xs</span>
    <span>&</span>
    <span>Os</span>
  </h1>
  <!-- Warning: the following code sucks, but it works, damn it! -->
  <div class="grid">

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell1">1</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell2">2</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell3">3</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell4">4</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell5">5</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell6">6</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell7">7</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell8">8</span></div>
</label>

<label>
    <input type="checkbox">
    <div class="mark"><span id="cell9">9</span></div>
</label>

</div>
</form>
</main>

</body></html>
